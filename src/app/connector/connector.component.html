<div class="container-fluid">
    <div class="row">
        <div id="drag-area" class="drag-bounds">
            <div *ngFor='let package of packages; index as j'>
                <div class="draggable-box" cdkDrag [ngStyle]="{ 'margin-top': 50 * (j+1) + 'px' }">
                    <div *ngFor="let node of package.$nodes | callback:isNodeIn; index as i">
                        <div 
                        class="node-left node-selector" 
                        [ngStyle]="{ 'margin-top': 15 * i + 'px', 'border-color': resolveLineTypeColor(node.type) }" 
                        [ngClass]="{ 'node-selected': firstSelectedNode == node }"
                        (click)="addRelation(node, $event)"></div>
                    </div>
                    <div *ngFor="let node of package.$nodes | callback:isNodeOut; index as i">
                        <div 
                        class="node-right node-selector" 
                        [ngStyle]="{ 'margin-top': 15 * i + 'px', 'border-color': resolveLineTypeColor(node.type) }" 
                        [ngClass]="{ 'node-selected': firstSelectedNode == node }"
                        (click)="addRelation(node, $event)"></div>
                    </div>
                    {{package.$name}}
                </div>
            </div>
            <svg style="position:relative; left:0; top:0;" width="100%" height="100vh">
                <line 
                    *ngFor="let relation of relations" 
                    [attr.x1]="getXposFromElement(relation.getPublisherElement())" 
                    [attr.y1]="getYposFromElement(relation.getPublisherElement())" 
                    [attr.x2]="getXposFromElement(relation.getSubscriberElement())" 
                    [attr.y2]="getYposFromElement(relation.getSubscriberElement())" 
                    [attr.stroke]="resolveLineTypeColor(relation.getPublisherNode().$type)"
                    stroke-width="4" stroke-linecap="round"/>
            </svg>
        </div>
        <div id="side-menu">
            <div class="row" *ngFor="let package of packageList">
                <div class="col-12 mb-3 ml-1">
                    <button class="btn btn-success" (click)="addPackage(package)">Add {{ package.$name }}</button>
                </div>
            </div>
        </div>
    </div>
</div>